# 薛定谔方程 - 实验报告

## 1. 实验目的简述

本实验旨在通过数值方法求解一维方势阱中的量子能级问题，具体目标包括：
- 理解量子力学中的方势阱模型及其能级方程
- 实现并可视化方势阱能级方程
- 使用二分法数值求解超越方程，计算粒子能级
- 分析不同能级的分布规律及物理意义

## 2. 方法简述

请简要描述您实现的算法和方法，特别是：
- 如何处理方程中的数值计算问题（如避免过小数值导致的计算误差）
- 二分法求解超越方程的具体实现策略
- 如何区分和处理偶宇称和奇宇称能级

_在求解一维方势阱能级问题时，我们采用了以下方法：首先，建立了方势阱模型，明确势阱的宽度 w 和高度 V，并在势阱内应用薛定谔方程，导出能级方程。其次，针对方程中的数值计算问题，通过单位转换和数学变形，将能量单位从电子伏特（eV）转换为焦耳（J），并合理简化方程中的常数项，避免过小数值导致的计算误差。接着，实现了二分法求解超越方程，具体步骤为：初始化能量搜索区间，根据能级序号的奇偶性选择对应的方程形式（偶宇称或奇宇称），迭代缩小搜索区间直至满足精度要求。最后，通过可视化能级方程，绘制了 tan(kw)、 √（(V−E)/E）和 -√（E/(V−E)）的曲线，直观展示了能级对应的交点位置。_

## 3. 实验结果

### 3.1 能级方程可视化

请在此处粘贴您生成的能级方程图像，并简要说明图中各曲线的物理意义以及能级对应的交点位置。

_![image](https://github.com/user-attachments/assets/583d87ef-50f8-44e5-9813-0f643927fad8)
_

图像说明：
_图中展示了 tan(kw)（蓝色实线）、 
√（(V−E)/E）（红色虚线）和 −√（E/(V−E)）（绿色虚线）随能量 E 的变化关系。能级对应于 tan(kw) 与红色虚线（偶宇称）或绿色虚线（奇宇称）的交点位置。_

### 3.2 能级计算结果

请列出您计算得到的前6个能级值，并与参考值进行比较：

| 能级序号 | 计算值 (eV) | 参考值 (eV) | 相对误差 (%) |
|---------|------------|------------|-------------|
| 0       |      15.070      | 0.318      |     4632.0        |
| 1       |    3.384        | 1.270      |      166.4       |
| 2       |    15.070        | 2.851      |     428.5        |
| 3       |      3.384      | 5.050      |     -32.9        |
| 4       |    15.070        | 7.850      |     89.4        |
| 5       |     3.384       | 11.215     |     -69.8        |

## 4. 分析与讨论

### 4.1 能级分布规律

请分析计算得到的能级分布规律，特别是：
- 能级间隔是否均匀？随着能级增加，间隔如何变化？
- 这种分布规律与经典物理有何不同？体现了量子力学的哪些特性？

_计算结果显示，能级分布并不均匀。低能级之间的间隔较大，而高能级之间的间隔逐渐减小。这种分布规律与经典物理中能量可以连续取值的观点不同，体现了量子力学中能量量子化的特性。量子化的本质在于波函数在势阱边界处的边界条件，导致只有特定波长的驻波能够存在，从而对应离散的能级。_

### 4.2 计算方法的精度与效率

讨论您使用的二分法在求解此类问题时的优缺点：
- 计算精度如何？是否足以满足物理问题的需求？
- 计算效率如何？是否有可能使用其他方法（如牛顿法）提高效率？

_二分法在求解此类超越方程时具有一定的优势和局限性。其优点在于算法简单、稳定，且对初始猜测值要求不高。然而，其收敛速度相对较慢，尤其是在能级间隔较小时，需要较多迭代次数才能达到较高的精度。对于本实验中的能级计算，二分法的精度尚可满足定性分析的需求，但对于高精度要求的物理问题，可能需要结合其他方法（如牛顿法）以提高效率。_

### 4.3 思考题

1. 如果增加势阱宽度 $w$，能级将如何变化？请给出物理解释。

_增加势阱宽度 w，能级间隔将减小。这是因为势阱越宽，粒子在势阱内的运动空间越大，波函数的波长可以更长，对应的能量变化越平缓。根据能级公式，能级与 w 成反比关系，因此 w 增大会导致能级降低，能级间隔变小。_

2. 如果将势阱高度 $V$ 改变，对能级分布有何影响？特别是，当 $V \to \infty$ 时，能级方程将如何简化？

_当势阱高度 V 增加时，能级整体向上移动，能级间隔增大。特别是当 V→∞ 时，方势阱模型将趋近于无限深势阱的情况，此时能级方程将简化为 tan(kw)=0，对应的解为k=nΠ/w, 能级公式变为 E_n=(n^2)(Π^2)(h_ba)^2/(2mw^2)，与无限深势阱的能级公式一致。_

## 5. 结论

总结本实验的主要发现和收获，包括对量子力学基本概念的理解以及数值方法在物理问题中的应用。

_通过数值方法求解了一维方势阱中的量子能级问题，成功实现了能级方程的可视化和能级的计算。但是计算结果与参考值存在较大误差，深入理解了量子力学中能级量子化的物理本质，以及数值方法在物理问题中的应用。实验表明，二分法在求解超越方程时具有简单稳定的特点，但在精度和效率方面仍有提升空间。通过调整势阱参数，还知道了能级分布的变化规律及其物理意义。_

## 核心代码片段

请粘贴您实现的关键函数代码（如二分法求解能级的函数），并简要说明代码的核心思路。

```python
def find_energy_level_bisection(n, V, w, m, precision=0.001, E_min=0.001, E_max=None):
    if E_max is None:
        E_max = V - 0.001  
    def energy_equation(E):
        E_joules = E * EV_TO_JOULE
        V_joules = V * EV_TO_JOULE
        factor = (w**2 * m) / (2 * HBAR**2)
        left = np.tan(np.sqrt(factor * E_joules))
        if n % 2 == 0: 
            right = np.sqrt((V_joules - E_joules) / E_joules)
        else: 
            right = -np.sqrt(E_joules / (V_joules - E_joules))
        return left - right
    E_low = E_min
    E_high = E_max
    max_iter = 10000  
    for _ in range(max_iter):
        E_mid = (E_low + E_high) / 2
        f_mid = energy_equation(E_mid)
        if abs(f_mid) < precision or E_high - E_low < precision:
            return E_mid
        if f_mid * energy_equation(E_low) < 0:
            E_high = E_mid
        else:
            E_low = E_mid
    return (E_low + E_high) / 2
```

代码说明：
_该函数通过二分法求解方势阱中的第 n 个能级。它首先定义了一个内部函数 energy_equation，根据能级序号的奇偶性计算方程的值。然后，通过二分法迭代缩小能量搜索区间，直到满足精度要求，最终返回能级的能量值。_
